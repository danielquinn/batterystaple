#!/usr/bin/env python3

import sys

from batterystaple.password import Password
from batterystaple.colours import Colour

if len(sys.argv) == 1:
    print("Usage: {} <password>[ password[ ...]]".format(sys.argv[0]))
    sys.exit(1)

for password in sys.argv[1:]:

    password = Password(password)

    length = Colour.success("OK")
    if not password.check_length():
        length = Colour.danger("TOO SHORT")

    dictionary = Colour.success("OK")
    if not password.check_dictionary():
        dictionary = Colour.danger("FAIL")

    md5 = Colour.success("OK")
    if not password.check_rainbow("md5"):
        md5 = Colour.danger("FAIL")

    sha1 = Colour.success("OK")
    if not password.check_rainbow("sha1"):
        sha1 = Colour.danger("FAIL")

    sha256 = Colour.success("OK")
    if not password.check_rainbow("sha256"):
        sha256 = Colour.danger("FAIL")

    print("""
      Report for: {cleartext}
      Length: {length}
      Dictionary: {dictionary}
      Rainbows:
        MD5: {md5}
        SHA1: {sha1}
        SHA256: {sha256}
    \n""".format(
        cleartext=Colour.info(password.cleartext),
        length=length,
        dictionary=dictionary,
        md5=md5,
        sha1=sha1,
        sha256=sha256
    ))
